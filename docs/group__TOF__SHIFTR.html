<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>cdfr2020CarteCerveauProg: tof_shiftr</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">cdfr2020CarteCerveauProg
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a>  </div>
  <div class="headertitle">
<div class="title">tof_shiftr</div>  </div>
</div><!--header-->
<div class="contents">

<p>Resetting the tof is done via this shift register.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ga9c75fc56c0b7bab947d7b5872d5d05ca"><td class="memItemLeft" align="right" valign="top"><a id="ga9c75fc56c0b7bab947d7b5872d5d05ca"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>SHIFTR_DSAB_RCC</b>&#160;&#160;&#160;RCC_GPIOC</td></tr>
<tr class="separator:ga9c75fc56c0b7bab947d7b5872d5d05ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gadd7b00f97a51e8da5bc5b8baaf2d16c6"><td class="memItemLeft" align="right" valign="top"><a id="gadd7b00f97a51e8da5bc5b8baaf2d16c6"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>SHIFTR_DSAB_PORT</b>&#160;&#160;&#160;GPIOC</td></tr>
<tr class="separator:gadd7b00f97a51e8da5bc5b8baaf2d16c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga08e58fde69ce93b5440c115ebdf56391"><td class="memItemLeft" align="right" valign="top"><a id="ga08e58fde69ce93b5440c115ebdf56391"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>SHIFTR_DSAB_PIN</b>&#160;&#160;&#160;GPIO1</td></tr>
<tr class="separator:ga08e58fde69ce93b5440c115ebdf56391"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad8295225338f1b0d2f0ff212a7ce0763"><td class="memItemLeft" align="right" valign="top"><a id="gad8295225338f1b0d2f0ff212a7ce0763"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>SHIFTR_CP_RCC</b>&#160;&#160;&#160;RCC_GPIOC</td></tr>
<tr class="separator:gad8295225338f1b0d2f0ff212a7ce0763"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaef676788099f23ed0521b927993c0af2"><td class="memItemLeft" align="right" valign="top"><a id="gaef676788099f23ed0521b927993c0af2"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>SHIFTR_CP_PORT</b>&#160;&#160;&#160;GPIOC</td></tr>
<tr class="separator:gaef676788099f23ed0521b927993c0af2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9a71ef0c49ed0c7486ac1ff7ab1ec9e6"><td class="memItemLeft" align="right" valign="top"><a id="ga9a71ef0c49ed0c7486ac1ff7ab1ec9e6"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>SHIFTR_CP_PIN</b>&#160;&#160;&#160;GPIO0</td></tr>
<tr class="separator:ga9a71ef0c49ed0c7486ac1ff7ab1ec9e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Resetting the tof is done via this shift register. </p>
<p>DSAB: data pin CP: clock pin for the shift</p>
<p>Registre à décalage : à cause de la configuration interne des ToFs, il n'est pas possible de les reset tous en même temps car alors les adresses I2C se réattribueraient un peu n'importe comment et ne permettraient plus au microcontrôleur de savoir quel ToF a quelle adresse. C'est pourquoi on a choisi d'utiliser un registre à décalage : Lorsqu'il faut reset les ToFs, on passe DSAB à 1 puis on envoie une impulsion sur CP pour mettre ce 1 dans le premier bit du registre. Ceci aura pour effet de reset le premier ToF qui ne connaît alors plus son adresse. On passe DSAB à 0 pour éviter de reset plusieurs ToFs d'un coup. Ensuite on répète : "On envoie une impulsion sur CP pour faire passer le 1 du bit n au bit n+1 dans le registre.
Ce faisant, le n ème ToF n'est plus en état de reset et on peut lui réattribuer sa propre adresse sans crainte de confusion." On reset successivement tous les ToFs en leur réattribuant leur propre adresse à chaque fois </p>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
